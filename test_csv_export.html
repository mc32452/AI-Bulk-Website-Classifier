<!DOCTYPE html>
<html>
<head>
    <title>Test CSV Export</title>
</head>
<body>
    <h1>Test CSV Export</h1>
    <button onclick="testCSVExport()">Test CSV Export</button>
    <div id="output"></div>

    <script>
        function testCSVExport() {
            const testData = [
                {
                    domain: "google.com",
                    classification_label: "Portal",
                    summary: "Google search engine",
                    confidence_level: 0.95,
                    snippet: "Search the world's information..."
                },
                {
                    domain: "amazon.com",
                    classification_label: "Marketing",
                    summary: "Online retail platform",
                    confidence_level: 0.95,
                    snippet: "Shop online for electronics..."
                }
            ];

            // Convert to CSV
            const headers = ['Domain', 'Classification', 'Summary', 'Confidence', 'Snippet'];
            const csvContent = [
                headers.join(','),
                ...testData.map(row => [
                    row.domain,
                    row.classification_label,
                    `"${row.summary.replace(/"/g, '""')}"`, // Escape quotes
                    row.confidence_level,
                    `"${row.snippet.replace(/"/g, '""')}"` // Escape quotes
                ].join(','))
            ].join('\n');

            // Create download
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'test_results.csv';
            a.click();
            window.URL.revokeObjectURL(url);

            document.getElementById('output').innerHTML = '<p>CSV file downloaded!</p><pre>' + csvContent + '</pre>';
        }
    </script>
</body>
</html>
